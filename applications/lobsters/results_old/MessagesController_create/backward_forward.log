digraph MessagesController_create_forward_70290606223620 {
	n18 -> n19
	n19 -> n20
	n20 -> n23
	n23 -> n49
	n49 -> n50
	n20 -> n52
	n52 -> n57
	n57 -> n58
	n58 -> n63
	n63 -> n64
	n57 -> n60
	n60 -> n61
	n61 -> n63
	n52 -> n60
	n19 -> n21
	n21 -> n22
	n21 -> n50
	n18 [label=<<i>User.where</i>> color=crimson shape=doubleoctagon]; 
	n19 [label = <<i>User_where(session_token=Isession[u]_to_s).first</i>> color=coral1 ]
	n20 []
	n23 [label = <<i>user.is_active?</i>> ]
	n49 []
	n50 []
	n52 []
	n57 []
	n58 [label = <<i>@user.id</i>> ]
	n63 []
	n64 [label = <<i>Rails_logger.info</i>> ]
	n60 []
	n61 [label = <<i>@user.username</i>> ]
	n21 []
	n22 []
}

digraph MessagesController_create_backward_70290606223620 {
	n13 -> n18
	n17 -> n18
	n16 -> n17
	n15 -> n16
	n14 -> n15
	n3 -> n14
	n18 [label=<<i>User.where</i>> color=crimson shape=doubleoctagon]; 
	n13 []
	n17 []
	n16 [label = <<i>session[u].to_s</i>> ]
	n15 []
	n14 [label = <<i>self.session</i>> ]
	n3 []
}

digraph MessagesController_create_forward_70290606222360 {
	n19 -> n20
	n20 -> n23
	n23 -> n49
	n49 -> n50
	n20 -> n52
	n52 -> n57
	n57 -> n58
	n58 -> n63
	n63 -> n64
	n57 -> n60
	n60 -> n61
	n61 -> n63
	n52 -> n60
	n19 -> n21
	n21 -> n22
	n21 -> n50
	n19 [label=<<i>User_where(session_token=Isession[u]_to_s).first</i>> color=crimson shape=doubleoctagon]; 
	n20 []
	n23 [label = <<i>user.is_active?</i>> ]
	n49 []
	n50 []
	n52 []
	n57 []
	n58 [label = <<i>@user.id</i>> ]
	n63 []
	n64 [label = <<i>Rails_logger.info</i>> ]
	n60 []
	n61 [label = <<i>@user.username</i>> ]
	n21 []
	n22 []
}

digraph MessagesController_create_backward_70290606222360 {
	n18 -> n19
	n13 -> n18
	n17 -> n18
	n16 -> n17
	n15 -> n16
	n14 -> n15
	n3 -> n14
	n19 [label=<<i>User_where(session_token=Isession[u]_to_s).first</i>> color=crimson shape=doubleoctagon]; 
	n18 [label = <<i>User.where</i>> color=coral1 ]
	n13 []
	n17 []
	n16 [label = <<i>session[u].to_s</i>> ]
	n15 []
	n14 [label = <<i>self.session</i>> ]
	n3 []
}

digraph MessagesController_create_forward_70290601836400 {
	n122 [label=<<i>Keystore.transaction</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290601836400 {
	n121 -> n122
	n72 -> n122
	n122 [label=<<i>Keystore.transaction</i>> color=crimson shape=doubleoctagon]; 
	n121 []
	n72 []
}

digraph MessagesController_create_forward_70290601814700 {
	n156 -> n158
	n158 -> n159
	n159 -> n160
	n160 -> n164
	n159 -> n162
	n156 [label=<<i>self.lock</i>> color=crimson shape=doubleoctagon]; 
	n158 [label = <<i>self_lock(true).where</i>> color=coral1 ]
	n159 [label = <<i>%cl_1_5.first</i>> ]
	n160 []
	n164 []
	n162 []
}

digraph MessagesController_create_backward_70290601814700 {
	n151 -> n156
	n156 [label=<<i>self.lock</i>> color=crimson shape=doubleoctagon]; 
	n151 []
}

digraph MessagesController_create_forward_70290601813200 {
	n158 -> n159
	n159 -> n160
	n160 -> n164
	n159 -> n162
	n158 [label=<<i>self_lock(true).where</i>> color=crimson shape=doubleoctagon]; 
	n159 [label = <<i>%cl_1_5.first</i>> ]
	n160 []
	n164 []
	n162 []
}

digraph MessagesController_create_backward_70290601813200 {
	n156 -> n158
	n151 -> n156
	n157 -> n158
	n158 [label=<<i>self_lock(true).where</i>> color=crimson shape=doubleoctagon]; 
	n156 [label = <<i>self.lock</i>> color=coral1 ]
	n151 []
	n157 []
}

digraph MessagesController_create_forward_70290601770480 {
	n182 -> n187
	n182 [label=<<i>kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n187 []
}

digraph MessagesController_create_backward_70290601770480 {
	n178 -> n182
	n174 -> n178
	n180 -> n182
	n178 -> n180
	n182 [label=<<i>kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n178 []
	n174 []
	n180 []
}

digraph MessagesController_create_forward_70290601767280 {
	n185 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290601767280 {
	n185 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_forward_70290601713600 {
	n255 [label=<<i>traffic_kv.save!</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290601713600 {
	n228 -> n255
	n227 -> n228
	n226 -> n227
	n225 -> n227
	n253 -> n255
	n228 -> n253
	n233 -> n253
	n232 -> n233
	n231 -> n232
	n230 -> n231
	n227 -> n230
	n242 -> n253
	n241 -> n242
	n233 -> n241
	n240 -> n241
	n239 -> n240
	n238 -> n239
	n237 -> n239
	n236 -> n237
	n235 -> n236
	n223 -> n235
	n136 -> n223
	n131 -> n136
	n130 -> n131
	n129 -> n130
	n134 -> n136
	n135 -> n136
	n218 -> n136
	n149 -> n218
	n139 -> n149
	n218 -> n136
	n221 -> n136
	n220 -> n221
	n219 -> n220
	n132 -> n236
	n131 -> n132
	n248 -> n253
	n247 -> n248
	n246 -> n247
	n245 -> n246
	n244 -> n245
	n241 -> n244
	n255 [label=<<i>traffic_kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n228 []
	n227 [label = <<i>Keystore.find_or_create_key_for_update</i>> ]
	n226 []
	n225 []
	n253 []
	n233 []
	n232 []
	n231 [label = <<i>%cl_1_12.to_i</i>> ]
	n230 [label = <<i>%cl_1_11.value</i>> ]
	n242 []
	n241 []
	n240 [label = <<i>Time_now.to_i</i>> ]
	n239 []
	n238 []
	n237 []
	n236 []
	n235 [label = <<i>date_kv.value</i>> ]
	n223 []
	n136 [label = <<i>Keystore.find_or_create_key_for_update</i>> ]
	n131 [label = <<i>Time_now.to_i</i>> ]
	n130 [label = <<i>Time.now</i>> ]
	n129 []
	n134 []
	n135 []
	n218 []
	n149 [label = <<i>self.loop</i>> ]
	n139 []
	n221 []
	n220 []
	n219 []
	n132 []
	n248 []
	n247 [label = <<i>[[100,traffic]_max,10000].min</i>> ]
	n246 []
	n245 [label = <<i>[100,traffic].max</i>> ]
	n244 []
}

digraph MessagesController_create_forward_70290601710740 {
	n259 [label=<<i>date_kv.save!</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290601710740 {
	n223 -> n259
	n136 -> n223
	n131 -> n136
	n130 -> n131
	n129 -> n130
	n134 -> n136
	n135 -> n136
	n218 -> n136
	n149 -> n218
	n139 -> n149
	n218 -> n136
	n221 -> n136
	n220 -> n221
	n219 -> n220
	n257 -> n259
	n223 -> n257
	n132 -> n257
	n131 -> n132
	n259 [label=<<i>date_kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n223 []
	n136 [label = <<i>Keystore.find_or_create_key_for_update</i>> ]
	n131 [label = <<i>Time_now.to_i</i>> ]
	n130 [label = <<i>Time.now</i>> ]
	n129 []
	n134 []
	n135 []
	n218 []
	n149 [label = <<i>self.loop</i>> ]
	n139 []
	n221 []
	n220 []
	n219 []
	n257 []
	n132 []
}

digraph MessagesController_create_forward_70290601641980 {
	n324 -> n325
	n325 -> n326
	n326 -> n329
	n329 -> n330
	n330 -> n333
	n333 -> n334
	n333 -> n341
	n329 -> n335
	n335 -> n336
	n336 -> n339
	n339 -> n340
	n340 -> n341
	n325 -> n327
	n324 [label=<<i>Message.where</i>> color=crimson shape=doubleoctagon]; 
	n325 [label = <<i>Message_where(short_id=Iparams[message_id]||params[id]).first</i>> color=coral1 ]
	n326 []
	n329 []
	n330 [label = <<i>@message.author_user_id</i>> ]
	n333 []
	n334 []
	n341 []
	n335 []
	n336 [label = <<i>@message.recipient_user_id</i>> ]
	n339 []
	n340 []
	n327 []
}

digraph MessagesController_create_backward_70290601641980 {
	n316 -> n324
	n323 -> n324
	n322 -> n323
	n321 -> n322
	n320 -> n321
	n318 -> n323
	n317 -> n318
	n324 [label=<<i>Message.where</i>> color=crimson shape=doubleoctagon]; 
	n316 []
	n323 []
	n322 []
	n321 []
	n320 [label = <<i>self.params</i>> color=cyan3 ]
	n318 []
	n317 [label = <<i>self.params</i>> color=cyan3 ]
}

digraph MessagesController_create_forward_70290601640700 {
	n325 -> n326
	n326 -> n329
	n329 -> n330
	n330 -> n333
	n333 -> n334
	n333 -> n341
	n329 -> n335
	n335 -> n336
	n336 -> n339
	n339 -> n340
	n340 -> n341
	n325 -> n327
	n325 [label=<<i>Message_where(short_id=Iparams[message_id]||params[id]).first</i>> color=crimson shape=doubleoctagon]; 
	n326 []
	n329 []
	n330 [label = <<i>@message.author_user_id</i>> ]
	n333 []
	n334 []
	n341 []
	n335 []
	n336 [label = <<i>@message.recipient_user_id</i>> ]
	n339 []
	n340 []
	n327 []
}

digraph MessagesController_create_backward_70290601640700 {
	n324 -> n325
	n316 -> n324
	n323 -> n324
	n322 -> n323
	n321 -> n322
	n320 -> n321
	n318 -> n323
	n317 -> n318
	n325 [label=<<i>Message_where(short_id=Iparams[message_id]||params[id]).first</i>> color=crimson shape=doubleoctagon]; 
	n324 [label = <<i>Message.where</i>> color=coral1 ]
	n316 []
	n323 []
	n322 []
	n321 []
	n320 [label = <<i>self.params</i>> color=cyan3 ]
	n318 []
	n317 [label = <<i>self.params</i>> color=cyan3 ]
}

digraph MessagesController_create_forward_70290601403980 {
	n405 -> n406
	n406 -> n395
	n395 -> n408
	n408 -> n772
	n772 -> n773
	n773 -> n774
	n772 -> n805
	n805 -> n806
	n806 -> n807
	n405 [label=<<i>received_messages.where</i>> color=crimson shape=doubleoctagon]; 
	n406 []
	n395 [label = <<i>@user.undeleted_received_messages</i>> ]
	n408 []
	n772 []
	n773 [label = <<i>@messages.any?</i>> ]
	n774 []
	n805 []
	n806 [label = <<i>@messages.includes</i>> color=coral1 ]
	n807 [label = <<i>@messages_includes(author,recipient).each</i>> ]
}

digraph MessagesController_create_backward_70290601403980 {
	n404 -> n405
	n403 -> n405
	n397 -> n403
	n405 [label=<<i>received_messages.where</i>> color=crimson shape=doubleoctagon]; 
	n404 []
	n403 [label = <<i>self.received_messages</i>> ]
	n397 []
}

digraph MessagesController_create_forward_70290601392260 {
	n411 -> n732
	n411 [label=<<i>@new_message.save</i>> color=crimson shape=doubleoctagon]; 
	n732 []
}

digraph MessagesController_create_backward_70290601392260 {
	n410 -> n411
	n385 -> n410
	n358 -> n385
	n384 -> n385
	n370 -> n384
	n371 -> n384
	n358 -> n371
	n382 -> n371
	n381 -> n382
	n380 -> n381
	n379 -> n380
	n387 -> n410
	n385 -> n387
	n411 [label=<<i>@new_message.save</i>> color=crimson shape=doubleoctagon]; 
	n410 []
	n385 []
	n358 []
	n384 [label = <<i>Message.new</i>> ]
	n370 []
	n371 [label = <<i>self.message_params</i>> ]
	n382 []
	n381 [label = <<i>%v_4.permit</i>> ]
	n380 [label = <<i>params.require</i>> ]
	n379 [label = <<i>self.params</i>> color=cyan3 ]
	n387 []
}

digraph MessagesController_create_forward_70290601501100 {
	n437 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290601501100 {
	n437 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_forward_70290606144840 {
	n438 -> n439
	n439 -> n517
	n517 -> n422
	n422 -> n519
	n519 -> n413
	n438 [label=<<i>self_received_messages_unread.count</i>> color=crimson shape=doubleoctagon]; 
	n439 [label = <<i>Keystore.put</i>> ]
	n517 []
	n422 [label = <<i>self_recipient.update_unread_message_count!</i>> ]
	n519 []
	n413 [label = <<i>self.update_unread_counts</i>> ]
}

digraph MessagesController_create_backward_70290606144840 {
	n436 -> n438
	n435 -> n436
	n424 -> n435
	n438 [label=<<i>self_received_messages_unread.count</i>> color=crimson shape=doubleoctagon]; 
	n436 [label = <<i>self_received_messages.unread</i>> ]
	n435 [label = <<i>self.received_messages</i>> ]
	n424 []
}

digraph MessagesController_create_forward_70290595843040 {
	n473 [label=<<i>Keystore_connection.execute</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290595843040 {
	n457 -> n473
	n456 -> n457
	n472 -> n473
	n464 -> n472
	n463 -> n464
	n462 -> n463
	n461 -> n463
	n460 -> n461
	n458 -> n464
	n471 -> n472
	n465 -> n471
	n467 -> n471
	n441 -> n467
	n446 -> n467
	n468 -> n471
	n469 -> n471
	n441 -> n469
	n447 -> n469
	n470 -> n471
	n473 [label=<<i>Keystore_connection.execute</i>> color=crimson shape=doubleoctagon]; 
	n457 [label = <<i>Keystore.connection</i>> ]
	n456 []
	n472 []
	n464 []
	n463 []
	n462 []
	n461 [label = <<i>Keystore.table_name</i>> ]
	n460 []
	n458 []
	n471 []
	n465 []
	n467 [label = <<i>self.q</i>> ]
	n441 []
	n446 []
	n468 []
	n469 [label = <<i>self.q</i>> ]
	n447 []
	n470 []
}

digraph MessagesController_create_forward_70290617050300 {
	n503 -> n513
	n503 [label=<<i>Keystore_connection.execute</i>> color=crimson shape=doubleoctagon]; 
	n513 []
}

digraph MessagesController_create_backward_70290617050300 {
	n502 -> n503
	n497 -> n502
	n489 -> n497
	n485 -> n489
	n487 -> n489
	n486 -> n487
	n488 -> n489
	n496 -> n497
	n490 -> n496
	n492 -> n496
	n441 -> n492
	n446 -> n492
	n493 -> n496
	n494 -> n496
	n441 -> n494
	n447 -> n494
	n495 -> n496
	n501 -> n502
	n498 -> n501
	n500 -> n501
	n441 -> n500
	n447 -> n500
	n484 -> n503
	n483 -> n484
	n503 [label=<<i>Keystore_connection.execute</i>> color=crimson shape=doubleoctagon]; 
	n502 []
	n497 []
	n489 []
	n485 []
	n487 [label = <<i>Keystore.table_name</i>> ]
	n486 []
	n488 []
	n496 []
	n490 []
	n492 [label = <<i>self.q</i>> ]
	n441 []
	n446 []
	n493 []
	n494 [label = <<i>self.q</i>> ]
	n447 []
	n495 []
	n501 []
	n498 []
	n500 [label = <<i>self.q</i>> ]
	n484 [label = <<i>Keystore.connection</i>> ]
	n483 []
}

digraph MessagesController_create_forward_70290617036440 {
	n511 -> n512
	n512 -> n513
	n511 [label=<<i>kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n512 []
	n513 []
}

digraph MessagesController_create_backward_70290617036440 {
	n507 -> n511
	n506 -> n507
	n441 -> n506
	n446 -> n506
	n447 -> n506
	n511 [label=<<i>kv.save!</i>> color=crimson shape=doubleoctagon]; 
	n507 []
	n506 [label = <<i>self.find_or_create_key_for_update</i>> ]
	n441 []
	n446 []
	n447 []
}

digraph MessagesController_create_forward_70290616985640 {
	n540 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_backward_70290616985640 {
	n540 [label=<<i>self.where</i>> color=crimson shape=doubleoctagon]; 
}

digraph MessagesController_create_forward_70290617202020 {
	n806 -> n807
	n806 [label=<<i>@messages.includes</i>> color=blue shape=doubleoctagon]; 
	n807 [label = <<i>@messages_includes(author,recipient).each</i>> ]
}

digraph MessagesController_create_backward_70290617202020 {
	n805 -> n806
	n779 -> n805
	n772 -> n805
	n752 -> n772
	n408 -> n772
	n358 -> n408
	n395 -> n408
	n394 -> n395
	n388 -> n394
	n358 -> n388
	n406 -> n395
	n405 -> n406
	n404 -> n405
	n403 -> n405
	n397 -> n403
	n806 [label=<<i>@messages.includes</i>> color=blue shape=doubleoctagon]; 
	n805 []
	n779 []
	n772 []
	n752 []
	n408 []
	n358 []
	n395 [label = <<i>@user.undeleted_received_messages</i>> ]
	n394 []
	n388 []
	n406 []
	n405 [label = <<i>received_messages.where</i>> color=coral1 ]
	n404 []
	n403 [label = <<i>self.received_messages</i>> ]
	n397 []
}

