digraph MessagesController_keep_as_new {
MessagesController_before_filter__BB1:f0 -> ApplicationController_before_filter__BB1 [label = ""]; 
ApplicationController_before_filter__BB1:f0 -> ApplicationController_authenticate_user__BB1 [label = ""]; 
ApplicationController_authenticate_user__BB5:f0 -> User_before_filter__BB1 [label = ""]; 
subgraph cluster_User_before_filter {
	color=red;
	node [style=filled];
	label = "User_before_filter"
	User_before_filter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
ApplicationController_authenticate_user__BB5:f0 -> User_is_active__BB1 [label = ""]; 
User_is_active__BB1 -> ApplicationController_authenticate_user__BB5:f0 [label = "r: (true)"]; 
User_is_active__BB3:f0 -> User_is_banned__BB1 [label = ""]; 
subgraph cluster_User_is_banned {
	color=red;
	node [style=filled];
	label = "User_is_banned?"
	User_is_banned__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_banned__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_banned__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_banned__BB1 -> User_is_banned__BB3 [ color=blue ];
	User_is_banned__BB1 -> User_is_banned__BB2 [ color=blue ];
	User_is_banned__BB2 -> User_is_banned__BB3 [ color=blue ];
}
subgraph cluster_User_is_active {
	color=red;
	node [style=filled];
	label = "User_is_active?"
	User_is_active__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_active__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_active__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> User.is_banned?</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_active__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_active__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_is_active__BB1 -> User_is_active__BB5 [ color=blue ];
	User_is_active__BB1 -> User_is_active__BB2 [ color=blue ];
	User_is_active__BB2 -> User_is_active__BB3 [ color=blue ];
	User_is_active__BB2 -> User_is_active__BB4 [ color=blue ];
	User_is_active__BB3 -> User_is_active__BB4 [ color=blue ];
	User_is_active__BB4 -> User_is_active__BB5 [ color=blue ];
}
subgraph cluster_ApplicationController_authenticate_user {
	color=red;
	node [style=filled];
	label = "ApplicationController_authenticate_user"
	ApplicationController_authenticate_user__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.session</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.session</td></tr>
			<tr><td port="f1" border="1" bgcolor="orange"> [QUERY]User.where </td></tr>
			<tr><td port="f2" border="1" bgcolor="orange"> [QUERY]User.where.first </td></tr>
			<tr><td port="f3" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> User.is_active?</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB10 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_authenticate_user__BB1 -> ApplicationController_authenticate_user__BB10 [ color=blue ];
	ApplicationController_authenticate_user__BB1 -> ApplicationController_authenticate_user__BB2 [ color=blue ];
	ApplicationController_authenticate_user__BB2 -> ApplicationController_authenticate_user__BB3 [ color=blue ];
	ApplicationController_authenticate_user__BB2 -> ApplicationController_authenticate_user__BB4 [ color=blue ];
	ApplicationController_authenticate_user__BB3 -> ApplicationController_authenticate_user__BB4 [ color=blue ];
	ApplicationController_authenticate_user__BB4 -> ApplicationController_authenticate_user__BB5 [ color=blue ];
	ApplicationController_authenticate_user__BB4 -> ApplicationController_authenticate_user__BB6 [ color=blue ];
	ApplicationController_authenticate_user__BB5 -> ApplicationController_authenticate_user__BB6 [ color=blue ];
	ApplicationController_authenticate_user__BB6 -> ApplicationController_authenticate_user__BB7 [ color=blue ];
	ApplicationController_authenticate_user__BB6 -> ApplicationController_authenticate_user__BB8 [ color=blue ];
	ApplicationController_authenticate_user__BB7 -> ApplicationController_authenticate_user__BB9 [ color=blue ];
	ApplicationController_authenticate_user__BB8 -> ApplicationController_authenticate_user__BB9 [ color=blue ];
	ApplicationController_authenticate_user__BB9 -> ApplicationController_authenticate_user__BB10 [ color=blue ];
}
subgraph cluster_ApplicationController_before_filter {
	color=red;
	node [style=filled];
	label = "ApplicationController_before_filter"
	ApplicationController_before_filter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.authenticate_user</td></tr>
			<tr><td port="f1" border="1"> ApplicationController.increase_traffic_counter</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
User_is_active__BB3:f0 -> ApplicationController_increase_traffic_counter__BB1 [label = ""]; 
ApplicationController_increase_traffic_counter__BB2:f0 -> ApplicationController_user_is_spider__BB1 [label = ""]; 
ApplicationController_user_is_spider__BB1 -> ApplicationController_increase_traffic_counter__BB2:f0 [label = "r: (true)"]; 
subgraph cluster_ApplicationController_user_is_spider {
	color=red;
	node [style=filled];
	label = "ApplicationController_user_is_spider?"
	ApplicationController_user_is_spider__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_user_is_spider__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.request</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_user_is_spider__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_user_is_spider__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_user_is_spider__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_user_is_spider__BB1 -> ApplicationController_user_is_spider__BB5 [ color=blue ];
	ApplicationController_user_is_spider__BB1 -> ApplicationController_user_is_spider__BB2 [ color=blue ];
	ApplicationController_user_is_spider__BB2 -> ApplicationController_user_is_spider__BB3 [ color=blue ];
	ApplicationController_user_is_spider__BB2 -> ApplicationController_user_is_spider__BB4 [ color=blue ];
	ApplicationController_user_is_spider__BB3 -> ApplicationController_user_is_spider__BB5 [ color=blue ];
	ApplicationController_user_is_spider__BB4 -> ApplicationController_user_is_spider__BB5 [ color=blue ];
}
ApplicationController_increase_traffic_counter_594378_closure0_BB3:f0 -> Keystore_before_filter_594378_closure0_BB1 [label = ""]; 
subgraph cluster_Keystore_before_filter {
	color=red;
	node [style=filled];
	label = "Keystore_before_filter"
	Keystore_before_filter_594378_closure0_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
ApplicationController_increase_traffic_counter_594378_closure0_BB3:f0 -> Keystore_find_or_create_key_for_update_594378_closure0_BB1 [label = "now_i, "]; 
Keystore_find_or_create_key_for_update_594378_closure0_BB1 -> ApplicationController_increase_traffic_counter_594378_closure0_BB3:f0 [label = "r: (date_kv)"]; 
Keystore_before_save_515556_closure0_closure1_closure2_BB3:f0 -> Keystore_before_save_515556_closure0_closure1_closure2_BB1 [label = ""]; 
subgraph cluster_Keystore_before_save {
	color=red;
	node [style=filled];
	label = "Keystore_before_save"
	Keystore_before_save_515556_closure0_closure1_closure2_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
Keystore_before_validation_515556_closure0_closure1_closure2_BB3:f0 -> Keystore_before_validation_515556_closure0_closure1_closure2_BB1 [label = ""]; 
subgraph cluster_Keystore_before_validation {
	color=red;
	node [style=filled];
	label = "Keystore_before_validation"
	Keystore_before_validation_515556_closure0_closure1_closure2_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]self.where </td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
Keystore_before_create_515556_closure0_closure1_closure2_BB3:f0 -> Keystore_before_create_515556_closure0_closure1_closure2_BB1 [label = ""]; 
subgraph cluster_Keystore_before_create {
	color=red;
	node [style=filled];
	label = "Keystore_before_create"
	Keystore_before_create_515556_closure0_closure1_closure2_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
subgraph cluster_Keystore_find_or_create_key_for_update {
	color=red;
	node [style=filled];
	label = "Keystore_find_or_create_key_for_update"
	Keystore_find_or_create_key_for_update_594378_closure0_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]self.lock </td></tr>
			<tr><td port="f1" border="1" bgcolor="orange"> [QUERY]self.lock.where </td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]kv.save! </td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.create!</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB10 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB11 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB13 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB14 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB15 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB17 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB18 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.loop</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_find_or_create_key_for_update_594378_closure0_BB1 -> Keystore_find_or_create_key_for_update_594378_closure0_BB8 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB1 -> Keystore_find_or_create_key_for_update_594378_closure0_BB2 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB2 -> Keystore_find_or_create_key_for_update_594378_closure0_BB4 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB2 -> Keystore_find_or_create_key_for_update_594378_closure0_BB5 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB2 -> Keystore_find_or_create_key_for_update_594378_closure0_BB6 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB4 -> Keystore_find_or_create_key_for_update_594378_closure0_BB5 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB5 -> Keystore_find_or_create_key_for_update_594378_closure0_BB6 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB5 -> Keystore_find_or_create_key_for_update_594378_closure0_BB8 [ color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB5:f0 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB1 [color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20:f0 -> Keystore_find_or_create_key_for_update_594378_closure0_BB5 [color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB1 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB1 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB2 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB2 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB3 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB3 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB4 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB3 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB5 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB3 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB18 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB4 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB18 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB4 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB5 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB9 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB10 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7:f0 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB1 [color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6:f0 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB7 [color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB1 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB1 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB2 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB2 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB3 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB3 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB4 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB3 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB4 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6 [ color=blue ];
	Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB6 -> Keystore_find_or_create_key_for_update_515556_closure0_closure1_closure2_BB1 [color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB9 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB17 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB10 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB11 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB10 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB10 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB11 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB11 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB13 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB14 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB12 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB13 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB13 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB14 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB15 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB14 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB15 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB17 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB18 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB16 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB17 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB18 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 [ color=blue ];
	Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB20 -> Keystore_find_or_create_key_for_update_980649_closure0_closure1_BB1 [color=blue ];
	Keystore_find_or_create_key_for_update_594378_closure0_BB6 -> Keystore_find_or_create_key_for_update_594378_closure0_BB8 [ color=blue ];
}
subgraph cluster_ApplicationController_increase_traffic_counter {
	color=red;
	node [style=filled];
	label = "ApplicationController_increase_traffic_counter"
	ApplicationController_increase_traffic_counter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.user_is_spider?</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.params</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
		color = green
	];
	ApplicationController_increase_traffic_counter__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter_594378_closure0_BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter_594378_closure0_BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter_594378_closure0_BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.find_or_create_key_for_update</td></tr>
			<tr><td port="f1" border="1"> Keystore.find_or_create_key_for_update</td></tr>
			<tr><td port="f2" border="1" bgcolor="orange"> [QUERY]traffic_kv.save! </td></tr>
			<tr><td port="f3" border="1" bgcolor="orange"> [QUERY]date_kv.save! </td></tr>
			<tr><td port="f4" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter_594378_closure0_BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter_594378_closure0_BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]Keystore.transaction </td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_increase_traffic_counter__BB1 -> ApplicationController_increase_traffic_counter__BB8 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB1 -> ApplicationController_increase_traffic_counter__BB2 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB2 -> ApplicationController_increase_traffic_counter__BB3 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB2 -> ApplicationController_increase_traffic_counter__BB4 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB3 -> ApplicationController_increase_traffic_counter__BB4 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB4 -> ApplicationController_increase_traffic_counter__BB5 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB4 -> ApplicationController_increase_traffic_counter__BB6 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB5 -> ApplicationController_increase_traffic_counter__BB8 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB6 -> ApplicationController_increase_traffic_counter__BB8 [ color=blue ];
	ApplicationController_increase_traffic_counter__BB6:f0 -> ApplicationController_increase_traffic_counter_594378_closure0_BB1 [color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB6:f0 -> ApplicationController_increase_traffic_counter__BB6 [color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB1 -> ApplicationController_increase_traffic_counter_594378_closure0_BB6 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB1 -> ApplicationController_increase_traffic_counter_594378_closure0_BB2 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB2 -> ApplicationController_increase_traffic_counter_594378_closure0_BB3 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB3 -> ApplicationController_increase_traffic_counter_594378_closure0_BB4 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB3 -> ApplicationController_increase_traffic_counter_594378_closure0_BB6 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB4 -> ApplicationController_increase_traffic_counter_594378_closure0_BB6 [ color=blue ];
	ApplicationController_increase_traffic_counter_594378_closure0_BB6 -> ApplicationController_increase_traffic_counter_594378_closure0_BB1 [color=blue ];
}
MessagesController_before_filter__BB1:f2 -> ApplicationController_require_logged_in_user__BB1 [label = ""]; 
subgraph cluster_ApplicationController_require_logged_in_user {
	color=red;
	node [style=filled];
	label = "ApplicationController_require_logged_in_user"
	ApplicationController_require_logged_in_user__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.request</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.session</td></tr>
			<tr><td port="f1" border="1"> ApplicationController.request</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ApplicationController_require_logged_in_user__BB1 -> ApplicationController_require_logged_in_user__BB9 [ color=blue ];
	ApplicationController_require_logged_in_user__BB1 -> ApplicationController_require_logged_in_user__BB2 [ color=blue ];
	ApplicationController_require_logged_in_user__BB2 -> ApplicationController_require_logged_in_user__BB3 [ color=blue ];
	ApplicationController_require_logged_in_user__BB2 -> ApplicationController_require_logged_in_user__BB4 [ color=blue ];
	ApplicationController_require_logged_in_user__BB3 -> ApplicationController_require_logged_in_user__BB9 [ color=blue ];
	ApplicationController_require_logged_in_user__BB4 -> ApplicationController_require_logged_in_user__BB5 [ color=blue ];
	ApplicationController_require_logged_in_user__BB4 -> ApplicationController_require_logged_in_user__BB6 [ color=blue ];
	ApplicationController_require_logged_in_user__BB5 -> ApplicationController_require_logged_in_user__BB7 [ color=blue ];
	ApplicationController_require_logged_in_user__BB6 -> ApplicationController_require_logged_in_user__BB7 [ color=blue ];
	ApplicationController_require_logged_in_user__BB7 -> ApplicationController_require_logged_in_user__BB9 [ color=blue ];
}
MessagesController_before_filter__BB1:f3 -> MessagesController_find_message__BB1 [label = ""]; 
subgraph cluster_MessagesController_find_message {
	color=red;
	node [style=filled];
	label = "MessagesController_find_message"
	MessagesController_find_message__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> MessagesController.params</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
		color = green
	];
	MessagesController_find_message__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> MessagesController.params</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
		color = green
	];
	MessagesController_find_message__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]Message.where </td></tr>
			<tr><td port="f1" border="1" bgcolor="orange"> [QUERY]Message_where(short_id=Iparams[message_id]||params[id]).first </td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB11 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB12 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> MessagesController.flash</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB14 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_find_message__BB1 -> MessagesController_find_message__BB14 [ color=blue ];
	MessagesController_find_message__BB1 -> MessagesController_find_message__BB2 [ color=blue ];
	MessagesController_find_message__BB2 -> MessagesController_find_message__BB3 [ color=blue ];
	MessagesController_find_message__BB2 -> MessagesController_find_message__BB4 [ color=blue ];
	MessagesController_find_message__BB3 -> MessagesController_find_message__BB4 [ color=blue ];
	MessagesController_find_message__BB4 -> MessagesController_find_message__BB5 [ color=blue ];
	MessagesController_find_message__BB4 -> MessagesController_find_message__BB11 [ color=blue ];
	MessagesController_find_message__BB5 -> MessagesController_find_message__BB6 [ color=blue ];
	MessagesController_find_message__BB5 -> MessagesController_find_message__BB7 [ color=blue ];
	MessagesController_find_message__BB6 -> MessagesController_find_message__BB7 [ color=blue ];
	MessagesController_find_message__BB7 -> MessagesController_find_message__BB8 [ color=blue ];
	MessagesController_find_message__BB7 -> MessagesController_find_message__BB9 [ color=blue ];
	MessagesController_find_message__BB8 -> MessagesController_find_message__BB14 [ color=blue ];
	MessagesController_find_message__BB9 -> MessagesController_find_message__BB12 [ color=blue ];
	MessagesController_find_message__BB11 -> MessagesController_find_message__BB12 [ color=blue ];
	MessagesController_find_message__BB12 -> MessagesController_find_message__BB14 [ color=blue ];
}
subgraph cluster_MessagesController_before_filter {
	color=red;
	node [style=filled];
	label = "MessagesController_before_filter"
	MessagesController_before_filter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ApplicationController.increase_traffic_counter</td></tr>
			<tr><td port="f1" border="1"> ApplicationController.authenticate_user</td></tr>
			<tr><td port="f2" border="1"> ApplicationController.require_logged_in_user</td></tr>
			<tr><td port="f3" border="1"> MessagesController.find_message</td></tr>
			<tr><td port="f4" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
MessagesController_find_message__BB12:f0 -> MessagesController_keep_as_new__BB1 [label = ""]; 
MessagesController_before_save__BB2:f0 -> Message_before_filter__BB1 [label = ""]; 
subgraph cluster_Message_before_filter {
	color=red;
	node [style=filled];
	label = "Message_before_filter"
	Message_before_filter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
MessagesController_before_save__BB2:f0 -> Message_before_save__BB1 [label = ""]; 
Message_before_save__BB1:f0 -> Message_update_unread_counts__BB1 [label = ""]; 
Message_update_unread_counts__BB2:f1 -> User_update_unread_message_count__BB1 [label = ""]; 
User_update_unread_message_count__BB2:f1 -> Message_unread__BB1 [label = ""]; 
subgraph cluster_Message_unread {
	color=red;
	node [style=filled];
	label = "Message_unread"
	Message_unread__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]self.where </td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
User_update_unread_message_count__BB2:f3 -> Keystore_put__BB1 [label = "self, self, "]; 
subgraph cluster_Keystore_put {
	color=red;
	node [style=filled];
	label = "Keystore_put"
	Keystore_put__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.connection</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.connection</td></tr>
			<tr><td port="f1" border="1"> Keystore.table_name</td></tr>
			<tr><td port="f2" border="1"> Keystore.q</td></tr>
			<tr><td port="f3" border="1"> Keystore.q</td></tr>
			<tr><td port="f4" border="1" bgcolor="orange"> [QUERY]Keystore.connection.execute </td></tr>
			<tr><td port="f5" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.connection</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.connection</td></tr>
			<tr><td port="f1" border="1"> Keystore.table_name</td></tr>
			<tr><td port="f2" border="1"> Keystore.q</td></tr>
			<tr><td port="f3" border="1"> Keystore.q</td></tr>
			<tr><td port="f4" border="1"> Keystore.q</td></tr>
			<tr><td port="f5" border="1" bgcolor="orange"> [QUERY]Keystore.connection.execute </td></tr>
			<tr><td port="f6" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Keystore.find_or_create_key_for_update</td></tr>
			<tr><td port="f1" border="1" bgcolor="orange"> [QUERY]kv.save! </td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Keystore_put__BB1 -> Keystore_put__BB9 [ color=blue ];
	Keystore_put__BB1 -> Keystore_put__BB2 [ color=blue ];
	Keystore_put__BB2 -> Keystore_put__BB3 [ color=blue ];
	Keystore_put__BB2 -> Keystore_put__BB4 [ color=blue ];
	Keystore_put__BB3 -> Keystore_put__BB8 [ color=blue ];
	Keystore_put__BB4 -> Keystore_put__BB5 [ color=blue ];
	Keystore_put__BB4 -> Keystore_put__BB6 [ color=blue ];
	Keystore_put__BB5 -> Keystore_put__BB7 [ color=blue ];
	Keystore_put__BB6 -> Keystore_put__BB7 [ color=blue ];
	Keystore_put__BB7 -> Keystore_put__BB8 [ color=blue ];
	Keystore_put__BB8 -> Keystore_put__BB9 [ color=blue ];
}
subgraph cluster_User_update_unread_message_count {
	color=red;
	node [style=filled];
	label = "User_update_unread_message_count!"
	User_update_unread_message_count__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_update_unread_message_count__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> User.received_messages</td></tr>
			<tr><td port="f1" border="1"> Message.unread</td></tr>
			<tr><td port="f2" border="1" bgcolor="orange"> [QUERY]self.received_messages.unread.count </td></tr>
			<tr><td port="f3" border="1"> Keystore.put</td></tr>
			<tr><td port="f4" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_update_unread_message_count__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_update_unread_message_count__BB1 -> User_update_unread_message_count__BB3 [ color=blue ];
	User_update_unread_message_count__BB1 -> User_update_unread_message_count__BB2 [ color=blue ];
	User_update_unread_message_count__BB2 -> User_update_unread_message_count__BB3 [ color=blue ];
}
subgraph cluster_Message_update_unread_counts {
	color=red;
	node [style=filled];
	label = "Message_update_unread_counts"
	Message_update_unread_counts__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_update_unread_counts__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> User.update_unread_message_count!</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_update_unread_counts__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_update_unread_counts__BB1 -> Message_update_unread_counts__BB3 [ color=blue ];
	Message_update_unread_counts__BB1 -> Message_update_unread_counts__BB2 [ color=blue ];
	Message_update_unread_counts__BB2 -> Message_update_unread_counts__BB3 [ color=blue ];
}
Message_before_save__BB1:f1 -> Message_check_for_both_deleted__BB1 [label = ""]; 
subgraph cluster_Message_check_for_both_deleted {
	color=red;
	node [style=filled];
	label = "Message_check_for_both_deleted"
	Message_check_for_both_deleted__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.destroy</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_check_for_both_deleted__BB1 -> Message_check_for_both_deleted__BB8 [ color=blue ];
	Message_check_for_both_deleted__BB1 -> Message_check_for_both_deleted__BB2 [ color=blue ];
	Message_check_for_both_deleted__BB2 -> Message_check_for_both_deleted__BB3 [ color=blue ];
	Message_check_for_both_deleted__BB2 -> Message_check_for_both_deleted__BB4 [ color=blue ];
	Message_check_for_both_deleted__BB3 -> Message_check_for_both_deleted__BB4 [ color=blue ];
	Message_check_for_both_deleted__BB4 -> Message_check_for_both_deleted__BB5 [ color=blue ];
	Message_check_for_both_deleted__BB4 -> Message_check_for_both_deleted__BB6 [ color=blue ];
	Message_check_for_both_deleted__BB5 -> Message_check_for_both_deleted__BB8 [ color=blue ];
	Message_check_for_both_deleted__BB6 -> Message_check_for_both_deleted__BB8 [ color=blue ];
}
subgraph cluster_Message_before_save {
	color=red;
	node [style=filled];
	label = "Message_before_save"
	Message_before_save__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.update_unread_counts</td></tr>
			<tr><td port="f1" border="1"> Message.check_for_both_deleted</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
MessagesController_before_validation__BB2:f0 -> Message_before_validation__BB1 [label = ""]; 
Message_before_validation__BB1:f3 -> Message_assign_short_id__BB1 [label = ""]; 
Message_assign_short_id__BB2:f2 -> ShortId_before_filter__BB1 [label = ""]; 
subgraph cluster_ShortId_before_filter {
	color=red;
	node [style=filled];
	label = "ShortId_before_filter"
	ShortId_before_filter__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
Message_assign_short_id__BB2:f2 -> ShortId_generate__BB1 [label = ""]; 
ShortId_generate__BB1 -> Message_assign_short_id__BB2:f2 [label = "r: (self.short_id)"]; 
ShortId_generate__BB3:f0 -> ShortId_candidate_id__BB1 [label = ""]; 
ShortId_candidate_id__BB1 -> ShortId_generate__BB3:f0 [label = "r: (generated_id)"]; 
subgraph cluster_ShortId_candidate_id {
	color=red;
	node [style=filled];
	label = "ShortId_candidate_id"
	ShortId_candidate_id__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_candidate_id__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ShortId.klass</td></tr>
			<tr><td port="f1" border="1"> CandidateId.new</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_candidate_id__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_candidate_id__BB1 -> ShortId_candidate_id__BB3 [ color=blue ];
	ShortId_candidate_id__BB1 -> ShortId_candidate_id__BB2 [ color=blue ];
	ShortId_candidate_id__BB2 -> ShortId_candidate_id__BB3 [ color=blue ];
}
subgraph cluster_ShortId_generate {
	color=red;
	node [style=filled];
	label = "ShortId_generate"
	ShortId_generate__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ShortId.candidate_id</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB5 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> ShortId.generation_attempts</td></tr>
			<tr><td port="f1" border="1"> ShortId.generation_attempts</td></tr>
			<tr><td port="f2" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB7 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB11 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB13 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	ShortId_generate__BB1 -> ShortId_generate__BB13 [ color=blue ];
	ShortId_generate__BB1 -> ShortId_generate__BB2 [ color=blue ];
	ShortId_generate__BB2 -> ShortId_generate__BB3 [ color=blue ];
	ShortId_generate__BB3 -> ShortId_generate__BB4 [ color=blue ];
	ShortId_generate__BB3 -> ShortId_generate__BB5 [ color=blue ];
	ShortId_generate__BB4 -> ShortId_generate__BB5 [ color=blue ];
	ShortId_generate__BB5 -> ShortId_generate__BB6 [ color=blue ];
	ShortId_generate__BB5 -> ShortId_generate__BB11 [ color=blue ];
	ShortId_generate__BB6 -> ShortId_generate__BB7 [ color=blue ];
	ShortId_generate__BB6 -> ShortId_generate__BB8 [ color=blue ];
	ShortId_generate__BB7 -> ShortId_generate__BB9 [ color=blue ];
	ShortId_generate__BB8 -> ShortId_generate__BB9 [ color=blue ];
	ShortId_generate__BB9 -> ShortId_generate__BB3 [ color=blue ];
	ShortId_generate__BB11 -> ShortId_generate__BB13 [ color=blue ];
}
subgraph cluster_Message_assign_short_id {
	color=red;
	node [style=filled];
	label = "Message_assign_short_id"
	Message_assign_short_id__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_assign_short_id__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.class</td></tr>
			<tr><td port="f1" border="1"> ShortId.new</td></tr>
			<tr><td port="f2" border="1"> ShortId.generate</td></tr>
			<tr><td port="f3" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_assign_short_id__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_assign_short_id__BB1 -> Message_assign_short_id__BB3 [ color=blue ];
	Message_assign_short_id__BB1 -> Message_assign_short_id__BB2 [ color=blue ];
	Message_assign_short_id__BB2 -> Message_assign_short_id__BB3 [ color=blue ];
}
subgraph cluster_Message_before_validation {
	color=red;
	node [style=filled];
	label = "Message_before_validation"
	Message_before_validation__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1" bgcolor="orange"> [QUERY]self.where </td></tr>
			<tr><td port="f2" border="1"> Message.author</td></tr>
			<tr><td port="f3" border="1"> Message.assign_short_id</td></tr>
			<tr><td port="f4" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
MessagesController_before_create__BB2:f0 -> Message_before_create__BB1 [label = ""]; 
Message_before_create__BB1:f0 -> Message_deliver_email_notifications__BB1 [label = ""]; 
Message_deliver_email_notifications__BB18:f2 -> Message_plaintext_body__BB1 [label = ""]; 
subgraph cluster_Message_plaintext_body {
	color=red;
	node [style=filled];
	label = "Message_plaintext_body"
	Message_plaintext_body__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_plaintext_body__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_plaintext_body__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_plaintext_body__BB1 -> Message_plaintext_body__BB3 [ color=blue ];
	Message_plaintext_body__BB1 -> Message_plaintext_body__BB2 [ color=blue ];
	Message_plaintext_body__BB2 -> Message_plaintext_body__BB3 [ color=blue ];
}
Message_deliver_email_notifications__BB18:f3 -> Message_url__BB1 [label = ""]; 
subgraph cluster_Message_url {
	color=red;
	node [style=filled];
	label = "Message_url"
	Message_url__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_url__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_url__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_url__BB1 -> Message_url__BB3 [ color=blue ];
	Message_url__BB1 -> Message_url__BB2 [ color=blue ];
	Message_url__BB2 -> Message_url__BB3 [ color=blue ];
}
Message_deliver_email_notifications__BB18:f5 -> User_pushover__BB1 [label = "Rails, "]; 
subgraph cluster_User_pushover {
	color=red;
	node [style=filled];
	label = "User_pushover!"
	User_pushover__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_pushover__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_pushover__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_pushover__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_pushover__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	User_pushover__BB1 -> User_pushover__BB6 [ color=blue ];
	User_pushover__BB1 -> User_pushover__BB2 [ color=blue ];
	User_pushover__BB2 -> User_pushover__BB3 [ color=blue ];
	User_pushover__BB2 -> User_pushover__BB4 [ color=blue ];
	User_pushover__BB3 -> User_pushover__BB6 [ color=blue ];
	User_pushover__BB4 -> User_pushover__BB6 [ color=blue ];
}
subgraph cluster_Message_deliver_email_notifications {
	color=red;
	node [style=filled];
	label = "Message_deliver_email_notifications"
	Message_deliver_email_notifications__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB3 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB6 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB8 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB9 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB10 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB11 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB12 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB13 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB14 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB15 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB16 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB17 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB18 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.recipient</td></tr>
			<tr><td port="f1" border="1"> Message.author</td></tr>
			<tr><td port="f2" border="1"> Message.plaintext_body</td></tr>
			<tr><td port="f3" border="1"> Message.url</td></tr>
			<tr><td port="f4" border="1"> Message.author</td></tr>
			<tr><td port="f5" border="1"> User.pushover!</td></tr>
			<tr><td port="f6" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB19 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB21 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	Message_deliver_email_notifications__BB1 -> Message_deliver_email_notifications__BB21 [ color=blue ];
	Message_deliver_email_notifications__BB1 -> Message_deliver_email_notifications__BB2 [ color=blue ];
	Message_deliver_email_notifications__BB2 -> Message_deliver_email_notifications__BB3 [ color=blue ];
	Message_deliver_email_notifications__BB2 -> Message_deliver_email_notifications__BB4 [ color=blue ];
	Message_deliver_email_notifications__BB3 -> Message_deliver_email_notifications__BB21 [ color=blue ];
	Message_deliver_email_notifications__BB4 -> Message_deliver_email_notifications__BB6 [ color=blue ];
	Message_deliver_email_notifications__BB4 -> Message_deliver_email_notifications__BB16 [ color=blue ];
	Message_deliver_email_notifications__BB6 -> Message_deliver_email_notifications__BB8 [ color=blue ];
	Message_deliver_email_notifications__BB8 -> Message_deliver_email_notifications__BB9 [ color=blue ];
	Message_deliver_email_notifications__BB8 -> Message_deliver_email_notifications__BB10 [ color=blue ];
	Message_deliver_email_notifications__BB9 -> Message_deliver_email_notifications__BB15 [ color=blue ];
	Message_deliver_email_notifications__BB10 -> Message_deliver_email_notifications__BB11 [ color=blue ];
	Message_deliver_email_notifications__BB10 -> Message_deliver_email_notifications__BB12 [ color=blue ];
	Message_deliver_email_notifications__BB10 -> Message_deliver_email_notifications__BB14 [ color=blue ];
	Message_deliver_email_notifications__BB11 -> Message_deliver_email_notifications__BB14 [ color=blue ];
	Message_deliver_email_notifications__BB11 -> Message_deliver_email_notifications__BB21 [ color=blue ];
	Message_deliver_email_notifications__BB12 -> Message_deliver_email_notifications__BB13 [ color=blue ];
	Message_deliver_email_notifications__BB12 -> Message_deliver_email_notifications__BB14 [ color=blue ];
	Message_deliver_email_notifications__BB13 -> Message_deliver_email_notifications__BB15 [ color=blue ];
	Message_deliver_email_notifications__BB14 -> Message_deliver_email_notifications__BB21 [ color=blue ];
	Message_deliver_email_notifications__BB15 -> Message_deliver_email_notifications__BB17 [ color=blue ];
	Message_deliver_email_notifications__BB16 -> Message_deliver_email_notifications__BB17 [ color=blue ];
	Message_deliver_email_notifications__BB17 -> Message_deliver_email_notifications__BB18 [ color=blue ];
	Message_deliver_email_notifications__BB17 -> Message_deliver_email_notifications__BB19 [ color=blue ];
	Message_deliver_email_notifications__BB18 -> Message_deliver_email_notifications__BB21 [ color=blue ];
	Message_deliver_email_notifications__BB19 -> Message_deliver_email_notifications__BB21 [ color=blue ];
}
subgraph cluster_Message_before_create {
	color=red;
	node [style=filled];
	label = "Message_before_create"
	Message_before_create__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> Message.deliver_email_notifications</td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
}
subgraph cluster_MessagesController_keep_as_new {
	color=red;
	node [style=filled];
	label = "MessagesController_keep_as_new"
	MessagesController_keep_as_new__BB1 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_keep_as_new__BB2 [
		label = <<table border="2">
			<tr><td port="f0" border="1" bgcolor="orange"> [QUERY]@message.save </td></tr>
			<tr><td port="f1" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_keep_as_new__BB4 [
		label = <<table border="2">
			<tr><td port="f0" border="1"> (nil) </td></tr>
		</table>>
		shape = none
	];
	MessagesController_keep_as_new__BB1 -> MessagesController_keep_as_new__BB4 [ color=blue ];
	MessagesController_keep_as_new__BB1 -> MessagesController_keep_as_new__BB2 [ color=blue ];
	MessagesController_keep_as_new__BB2 -> MessagesController_keep_as_new__BB4 [ color=blue ];
}
}