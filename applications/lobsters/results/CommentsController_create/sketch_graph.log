digraph sketch {
	n20 [label=<<i>20__ User(User)   where</i>> color=blue]; 
	n20 -> n21 [label="0"]
	n21 [label=<<i>21__ User where( session_token =) session( u) to_s)   first</i>> color=blue]; 
	n109 [label=<<i>109__ self(ApplicationController)   params</i>> color=crimson]; 
	n142 [label=<<i>142__ self lock(true) where( key =) key)   first</i>> color=blue]; 
	n143 [label=<<i>143__ self lock(true)   where</i>> color=blue]; 
	n144 [label=<<i>144__ self(Keystore)   lock</i>> color=blue]; 
	n151 [label=<<i>151__ key   where</i>> color=blue]; 
	n153 [label=<<i>153__ kv(Keystore)   save!</i>> color=blue]; 
	n184 [label=<<i>184__ traffic_kv(Keystore)   value</i>> color=darkorange]; 
	n184 -> n186 [label="0"]
	n186 [label=<<i>186__ traffic_kv(Keystore)   save!</i>> color=blue]; 
	n188 [label=<<i>188__ date_kv(Keystore)   value</i>> color=darkorange]; 
	n188 -> n190 [label="0"]
	n190 [label=<<i>190__ date_kv(Keystore)   save!</i>> color=blue]; 
	n238 [label=<<i>238__ self(CommentsController)   params</i>> color=crimson]; 
	n238 -> n241 [label="2"]
	n241 [label=<<i>241__ Story(Story)   where</i>> color=blue]; 
	n241 -> n242 [label="0"]
	n242 [label=<<i>242__ Story where( short_id =) params( story_id))   first</i>> color=blue]; 
	n242 -> n308 [label="3"]
	n242 -> n335 [label="3"]
	n242 -> n1682 [label="4"]
	n242 -> n1582 [label="8"]
	n242 -> n1271 [label="9"]
	n242 -> n563 [label="11"]
	n242 -> n772 [label="11"]
	n242 -> n774 [label="11"]
	n242 -> n1219 [label="11"]
	n242 -> n1467 [label="11"]
	n242 -> n1478 [label="11"]
	n242 -> n580 [label="12"]
	n242 -> n682 [label="12"]
	n242 -> n493 [label="13"]
	n242 -> n1124 [label="14"]
	n242 -> n1106 [label="15"]
	n242 -> n1111 [label="17"]
	n272 [label=<<i>272__ self(CommentsController)   params</i>> color=crimson]; 
	n272 -> n278 [label="1"]
	n272 -> n275 [label="2"]
	n275 [label=<<i>275__ comment(Comment)   comment</i>> color=darkorange]; 
	n275 -> n1682 [label="0"]
	n275 -> n335 [label="2"]
	n275 -> n1582 [label="4"]
	n275 -> n1271 [label="5"]
	n275 -> n563 [label="7"]
	n275 -> n772 [label="7"]
	n275 -> n774 [label="7"]
	n275 -> n1219 [label="7"]
	n275 -> n1467 [label="7"]
	n275 -> n1478 [label="7"]
	n275 -> n580 [label="8"]
	n275 -> n682 [label="8"]
	n275 -> n493 [label="9"]
	n275 -> n1124 [label="10"]
	n275 -> n1106 [label="11"]
	n275 -> n1111 [label="13"]
	n278 [label=<<i>278__ comment(Comment)   user</i>> color=darkorange]; 
	n278 -> n1682 [label="0"]
	n278 -> n335 [label="2"]
	n278 -> n1582 [label="4"]
	n278 -> n1271 [label="5"]
	n278 -> n563 [label="7"]
	n278 -> n772 [label="7"]
	n278 -> n774 [label="7"]
	n278 -> n1219 [label="7"]
	n278 -> n1467 [label="7"]
	n278 -> n1478 [label="7"]
	n278 -> n580 [label="8"]
	n278 -> n682 [label="8"]
	n278 -> n493 [label="9"]
	n278 -> n1124 [label="10"]
	n278 -> n1106 [label="11"]
	n278 -> n1111 [label="13"]
	n280 [label=<<i>280__ self(CommentsController)   params</i>> color=crimson]; 
	n285 [label=<<i>285__ self(CommentsController)   params</i>> color=crimson]; 
	n292 [label=<<i>292__ self(CommentsController)   params</i>> color=crimson]; 
	n292 -> n294 [label="1"]
	n294 [label=<<i>294__ comment(Comment)   hat_id</i>> color=darkorange]; 
	n294 -> n1682 [label="0"]
	n294 -> n335 [label="2"]
	n294 -> n1582 [label="4"]
	n294 -> n1271 [label="5"]
	n294 -> n563 [label="7"]
	n294 -> n772 [label="7"]
	n294 -> n774 [label="7"]
	n294 -> n1219 [label="7"]
	n294 -> n1467 [label="7"]
	n294 -> n1478 [label="7"]
	n294 -> n580 [label="8"]
	n294 -> n682 [label="8"]
	n294 -> n493 [label="9"]
	n294 -> n1124 [label="10"]
	n294 -> n1106 [label="11"]
	n294 -> n1111 [label="13"]
	n298 [label=<<i>298__ self(CommentsController)   params</i>> color=crimson]; 
	n305 [label=<<i>305__ self(CommentsController)   params</i>> color=crimson]; 
	n305 -> n308 [label="2"]
	n308 [label=<<i>308__ Comment(Comment)   where</i>> color=blue]; 
	n308 -> n309 [label="0"]
	n309 [label=<<i>309__ Comment where( story_id =) story id,  short_id =)      params( parent_comment_short_id))   first</i>> color=blue]; 
	n313 [label=<<i>313__ comment(Comment)   parent_comment</i>> color=darkorange]; 
	n313 -> n1682 [label="0"]
	n313 -> n335 [label="2"]
	n313 -> n1582 [label="4"]
	n313 -> n1271 [label="5"]
	n313 -> n563 [label="7"]
	n313 -> n772 [label="7"]
	n313 -> n774 [label="7"]
	n313 -> n1219 [label="7"]
	n313 -> n1467 [label="7"]
	n313 -> n1478 [label="7"]
	n313 -> n580 [label="8"]
	n313 -> n682 [label="8"]
	n313 -> n493 [label="9"]
	n313 -> n1124 [label="10"]
	n313 -> n1106 [label="11"]
	n313 -> n1111 [label="13"]
	n324 [label=<<i>324__ self(CommentsController)   params</i>> color=crimson]; 
	n335 [label=<<i>335__ Comment(Comment)   where</i>> color=blue]; 
	n335 -> n336 [label="0"]
	n336 [label=<<i>336__ Comment where( story_id =) story id,  short_id =)      params( parent_comment_short_id))   first</i>> color=blue]; 
	n493 [label=<<i>493__ self(Comment)   short_id</i>> color=darkorange]; 
	n495 [label=<<i>495__ _self(Comment)   upvotes</i>> color=darkorange]; 
	n563 [label=<<i>563__ self(Comment)   confidence</i>> color=darkorange]; 
	n580 [label=<<i>580__ self(Comment)   thread_id</i>> color=darkorange]; 
	n591 [label=<<i>591__ Keystore connection   execute</i>> color=blue]; 
	n595 [label=<<i>595__ Keystore connection   execute</i>> color=blue]; 
	n602 [label=<<i>602__ Keystore connection   execute</i>> color=blue]; 
	n612 [label=<<i>612__ kv   save!</i>> color=blue]; 
	n616 [label=<<i>616__ self where( key =) key) first   try</i>> color=blue]; 
	n617 [label=<<i>617__ self where( key =) key)   first</i>> color=blue]; 
	n618 [label=<<i>618__ self(Keystore)   where</i>> color=blue]; 
	n620 [label=<<i>620__ self(Comment)   thread_id</i>> color=darkorange]; 
	n682 [label=<<i>682__ Vote(Vote)   where</i>> color=blue]; 
	n682 -> n683 [label="0"]
	n683 [label=<<i>683__ Vote where( user_id =) user_id,  story_id =) story_id,       comment_id =) comment_id)   first_or_initialize</i>> color=blue]; 
	n683 -> n728 [label="1"]
	n683 -> n734 [label="1"]
	n683 -> n776 [label="1"]
	n683 -> n793 [label="2"]
	n683 -> n1009 [label="2"]
	n728 [label=<<i>728__ v(Vote)   destroy!</i>> color=blue]; 
	n734 [label=<<i>734__ v(Vote)   new_record?</i>> color=blue]; 
	n772 [label=<<i>772__ v(Vote)   vote</i>> color=darkorange]; 
	n772 -> n776 [label="0"]
	n772 -> n793 [label="1"]
	n772 -> n1009 [label="1"]
	n774 [label=<<i>774__ v(Vote)   reason</i>> color=darkorange]; 
	n774 -> n776 [label="0"]
	n774 -> n793 [label="1"]
	n774 -> n1009 [label="1"]
	n776 [label=<<i>776__ v(Vote)   save!</i>> color=blue]; 
	n793 [label=<<i>793__ Comment(Comment)   find</i>> color=blue]; 
	n793 -> n804 [label="2"]
	n793 -> n821 [label="5"]
	n793 -> n826 [label="5"]
	n793 -> n858 [label="7"]
	n793 -> n880 [label="8"]
	n793 -> n915 [label="9"]
	n804 [label=<<i>804__ User(User)   update_counters</i>> color=blue]; 
	n821 [label=<<i>821__ _self(Comment)   upvotes</i>> color=darkorange]; 
	n821 -> n858 [label="4"]
	n821 -> n880 [label="5"]
	n821 -> n915 [label="6"]
	n826 [label=<<i>826__ _self(Comment)   downvotes</i>> color=darkorange]; 
	n826 -> n858 [label="4"]
	n826 -> n880 [label="5"]
	n826 -> n915 [label="6"]
	n858 [label=<<i>858__ Comment connection   execute</i>> color=blue]; 
	n880 [label=<<i>880__ self tags(Tag)   select</i>> color=blue]; 
	n915 [label=<<i>915__ self comments(Comment)   where</i>> color=blue]; 
	n915 -> n916 [label="0"]
	n916 [label=<<i>916__ self comments where("user_id () ?", self user_id)   select</i>> color=blue]; 
	n1009 [label=<<i>1009__ Story(Story)   find</i>> color=blue]; 
	n1009 -> n1020 [label="2"]
	n1009 -> n1071 [label="6"]
	n1020 [label=<<i>1020__ User(User)   update_counters</i>> color=blue]; 
	n1071 [label=<<i>1071__ Story connection   execute</i>> color=blue]; 
	n1103 [label=<<i>1103__ Story(Story)   select</i>> color=blue]; 
	n1103 -> n1106 [label="0"]
	n1106 [label=<<i>1106__ Story select( id)   where</i>> color=blue]; 
	n1106 -> n1111 [label="2"]
	n1111 [label=<<i>1111__ Comment(Comment)   where</i>> color=blue]; 
	n1111 -> n1219 [label="2"]
	n1111 -> n1234 [label="2"]
	n1111 -> n1124 [label="3"]
	n1124 [label=<<i>1124__ self(Comment)   order</i>> color=blue]; 
	n1188 [label=<<i>1188__ node(Comment)   indent_level</i>> color=darkorange]; 
	n1219 [label=<<i>1219__ comments(Comment)   count</i>> color=blue]; 
	n1219 -> n1234 [label="0"]
	n1234 [label=<<i>1234__ self(Story)   comments_count</i>> color=darkorange]; 
	n1271 [label=<<i>1271__ self parent_comment   try</i>> color=blue]; 
	n1467 [label=<<i>1467__ self plaintext_comment scan(/\B\@((\w\-)+)/) flatten   uniq</i>> color=blue]; 
	n1467 -> n1478 [label="3"]
	n1478 [label=<<i>1478__ User(User)   where</i>> color=blue]; 
	n1478 -> n1479 [label="0"]
	n1479 [label=<<i>1479__ User where( username =) mention)   first</i>> color=blue]; 
	n1582 [label=<<i>1582__ comment(Comment)   new_record?</i>> color=blue]; 
	n1677 [label=<<i>1677__ self(CommentsController)   params</i>> color=crimson]; 
	n1682 [label=<<i>1682__ comment(Comment)   save</i>> color=blue]; 
	n1687 [label=<<i>1687__ comment(Comment)   current_vote</i>> color=darkorange]; 
	n1708 [label=<<i>1708__ comment(Comment)   upvotes</i>> color=darkorange]; 
	n1711 [label=<<i>1711__ comment(Comment)   current_vote</i>> color=darkorange]; 
}